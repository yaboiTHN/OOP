CREATE DATABASE Group10;
USE Group10;

CREATE TABLE Enrollments (
    StudentID INT NOT NULL,
    CourseCode VARCHAR(5) NOT NULL,
    EnrollmentDate DATE DEFAULT (CURRENT_DATE),   
    Email VARCHAR(100) UNIQUE,              
    CONSTRAINT PK_Enrollments PRIMARY KEY (StudentID, CourseCode)
);

INSERT INTO Enrollments (StudentID, CourseCode, Email) VALUES
(1, 'a111', 'student1@email.com'),
(1, 'b222', 'student2@email.com'),
(2, 'a111', 'student3@email.com'),
(2, 'b222', 'student4@email.com'),
(3, 'x999', 'student5@email.com'); 

CREATE TABLE Courses (
    CourseCode VARCHAR(5) NOT NULL,
    Credits INT NOT NULL CHECK (Credits > 0),
    CourseName VARCHAR(50) UNIQUE,           
    Department VARCHAR(30) DEFAULT 'General',  
    PRIMARY KEY (CourseCode)
);

INSERT INTO Courses (CourseCode, Credits, CourseName, Department) VALUES
('a111', 10, 'Math Basics', 'Mathematics'),
('b222', 20, 'Physics I', 'Science'),
('c333', 15, 'Chemistry Intro', 'Science'),
('d444', 30, 'Programming 101', 'Computer Science'),
('e555', 25, 'Database Systems', DEFAULT);

SELECT *
FROM Enrollments
WHERE CourseCode IN (SELECT CourseCode FROM Courses);

SELECT StudentID
FROM Enrollments
GROUP BY StudentID
HAVING COUNT(DISTINCT CourseCode) = 2;

SELECT Enrollments.StudentID, Enrollments.CourseCode, Courses.Credits
FROM Enrollments
INNER JOIN Courses ON Enrollments.CourseCode = Courses.CourseCode;

SELECT Enrollments.StudentID, Enrollments.CourseCode, Courses.Credits
FROM Enrollments
JOIN Courses ON Enrollments.CourseCode = Courses.CourseCode
WHERE Courses.Credits > 15;

SELECT Enrollments.StudentID, Enrollments.CourseCode, Courses.Credits
FROM Enrollments
JOIN Courses 
ON Enrollments.CourseCode = Courses.CourseCode;

SELECT *
FROM Enrollments
JOIN Courses;

SELECT *
FROM Enrollments
RIGHT OUTER JOIN Courses
ON Enrollments.CourseCode = Courses.CourseCode;

SELECT *
FROM Enrollments
LEFT OUTER JOIN Courses
ON Enrollments.CourseCode = Courses.CourseCode;

SELECT *
FROM Enrollments
LEFT JOIN Courses
ON Enrollments.CourseCode = Courses.CourseCode
UNION
SELECT *
FROM Enrollments
RIGHT JOIN Courses
ON Enrollments.CourseCode = Courses.CourseCode;


ALTER TABLE Enrollments
ADD CONSTRAINT fk_course
FOREIGN KEY (CourseCode)
REFERENCES Courses(CourseCode)
ON DELETE CASCADE
ON UPDATE CASCADE;

SELECT 
    CONSTRAINT_NAME,
    TABLE_NAME,
    COLUMN_NAME,
    REFERENCED_TABLE_NAME,
    REFERENCED_COLUMN_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
WHERE TABLE_NAME = 'Enrollments'
  AND REFERENCED_TABLE_NAME IS NOT NULL;



SET SQL_SAFE_UPDATES = 0;

DELETE FROM Enrollments
WHERE CourseCode = 'x999';

SET SQL_SAFE_UPDATES = 1; 


